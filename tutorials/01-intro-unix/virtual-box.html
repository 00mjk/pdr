<!doctype html>
<html>
<head>
</head>
<body>
<h1>Tutorial 1: Introduction to UNIX: VirtualBox Use</h1>

<p><a href="index.html">Go up to the main tutorial 1 page</a></p>

<p>VirtualBox is a free program that allows you to run another operating
system on your machine without needing to reinstall anything.  You
just have to install the VirtualBox client, which installs like any
other program and is available for many different platforms (Windows,
Mac, Linux).  We provide you with a pre-configured VirtualBox image
that contains an Ubuntu Linux installation that you can use for this
course.</p>

<h3>Quick start</h3>

<ul>
<li>A bit of terminology: the &lsquo;host&rsquo; machine is the physical computer
(laptop, desktop, etc.) that you are using.  The &lsquo;guest&rsquo; machine is
the virtual machine that is running in VirtualBox, and is often just
called the &lsquo;guest operating system&rsquo;.

<ul>
<li>You are welcome to try this on a netbook host machine, but the
computing power of a netbook may not be enough</li>
<li>Your unzip program complains about needing some insane amount of
space (like 700 petabytes, where a petabyte is 1,000 terabytes);
this is a bug in many unzip programs.  Try
<a href="http://www.7-zip.org/">7-zip</a>, which has had more success.</li>
</ul>
</li>
<li>You will need to install the Virtual Box client.  It can be
 downloaded for free from <a href="http://www.virtualbox.org/">here</a> and
 runs on most operating systems.

<ul>
<li>Under Linux, I installed the &lsquo;virtualbox-ose-qt&rsquo; package (the
name of yours might be different), but if you are running Linux
already, you won&rsquo;t need to install a virtual machine running
Linux&hellip;</li>
</ul>
</li>
<li>Download the provided VirtualBox image (from Collab, in the misc/
folder of the Resources tool).  You will need to unzip this file
before using it.

<ul>
<li>This file is rather large (over 2 Gb), so you may want to try
downloading it during off hours, such as late at night.  If you
have problems downloading it, let us know.  If you do not have
sufficient bandwidth to download it, please see us after lecture,
and we will provide it on a different media for you.</li>
</ul>
</li>
<li>Run VirtualBox, and import the image:

<ul>
<li>To do that, click on &lsquo;New&rsquo;, and choose the right OS/version
(Linux/Ubuntu - don&rsquo;t choose &ldquo;Ubuntu (64 bit)&rdquo;).  Give it a name
to help differentiate it from other virtual machines that you may
end up using in later classes.</li>
<li>Stay with the default memory amount (you can change it later)</li>
<li>At the &lsquo;Virtual Hard Disk&rsquo; screen select &lsquo;use existing hard disk&rsquo;,
and click the folder icon to the right of the drop-down list.  You
want to use the file you unzipped above.</li>
<li>That should be it for the Wizard</li>
</ul>
</li>
<li>Boot the machine (click the Start icon at the top - it&rsquo;s a green
rightward pointing arrow).  You may notice some display artifacts
during boot-up as the virtual machine changes video modes, but that
will stabilize once booting has completed.</li>
<li>The login is &lsquo;student&rsquo; (although you&rsquo;ll probably click on the &lsquo;L33t
Hax0r&rsquo; button on the login screen), and the password is &lsquo;password&rsquo;.
You can click on the command-prompt icon on the top toolbar to get a
terminal window.

<ul>
<li>The documentation is available online in either <a href="http://www.virtualbox.org/manual/UserManual.html">HTML
format</a> or <a href="http://download.virtualbox.org/virtualbox/UserManual.pdf">PDF
format</a>,
although most of the salient details are listed on this page.</li>
</ul>
</li>
</ul>


<h3>Notes</h3>

<ul>
<li>No root password is set (you can use &lsquo;sudo&rsquo; instead); to change the
root password, run &lsquo;sudo passwd&rsquo;.</li>
<li>The &lsquo;host key&rsquo; is defined by your host machine&rsquo;s operating system
(it&rsquo;s the right control button under Linux, for example).  This key
is used for a number of contexts, including un-capturing the mouse.
To have VirtualBox warn you about what the host key is, you can
reset all warnings via the VirtualBox help menu, and it will warn
you about this at boot-up.</li>
<li>We did not install the latest version of Ubuntu, but instead
installed the Long-Term Support (LTS) version, which is 12.04.  The
difference is that the LTS versions are supported for far longer (3
years or so) than the non-LTS versions (which are only supported for
a year or so).  For this class, there won&rsquo;t be a noticable
difference between 12.04 and more recent versions.</li>
<li>Sound and network should work automatically, as the VirtualBox
program will connect those to your host machine&rsquo;s sound and network
device drivers.</li>
</ul>


<h3>How-Tos</h3>

<ul>
<li>To load a terminal (a.k.a. command prompt): it&rsquo;s towards the bottom
of the menu on the left-hand launcher column.</li>
<li>To load emacs: it&rsquo;s also in the menu on the left-hand launcher
column, right above the terminal launcher icon</li>
<li>To change the password: when logged in, you enter the &lsquo;passwd&rsquo;
command from a terminal window.  You should do this.  The original
password is &lsquo;password&rsquo;.</li>
<li>To toggle between full-screen and windowed mode, click on the host
key and &lsquo;f&rsquo;.  Don&rsquo;t know what the host key is?  Read the bullet
point about this in the &lsquo;Notes&rsquo; section, above.</li>
<li>To change the screen resolution: from the top menu bar, click on the
circular power button icon on the far right, and select &lsquo;Displays&rsquo;.
Note that there are not many resolutions available, but you can use
full-screen mode which will change the resolution to your host
machine&rsquo;s resolution.</li>
<li>To set up printing: it&rsquo;s probably easiest to print to a PDF,
transfer that file to your host machine (see below), and print from
your host machine.</li>
<li>Load up a file manager (like Windows Explorer): from the &lsquo;Places&rsquo;
menu (upper-left of the screen), select &lsquo;Home Folder&rsquo;</li>
<li>Make emacs show one screen (and not be a split-screen): press
control-x then press &lsquo;1&rsquo; (this should not be necessary, by the way)</li>
</ul>


<h3>Transferring files back and forth</h3>

<p>The easiest solution may be the last one listed here, so read through
these before you start on any of them.</p>

<p>One option is to set up an e-mail client (or use a web browser -
firefox is installed, and the icon is on the top menu bar) and e-mail
your files back and forth.  Or use an online file server.</p>

<p>You can also set up &lsquo;shared folders&rsquo; to directly read and write files
back and forth.  To do this:</p>

<ul>
<li>Find the VirtualBox toolbar at the bottom (this is not the Gnome
toolbar at the bottom, but the toolbar that appears when you are
<strong>not</strong> in full-screen mode).  Right-click on the icon that looks
like a blue folder, and select &lsquo;shared folders&rsquo;.</li>
<li>Configure one (or more) shared folders.  You will need to select a
name for the shared folder (I&rsquo;ll assume it&rsquo;s called &lsquo;home&rsquo; for the
commands below), and the directory that it reads from and writes to.</li>
<li>This makes the folder available to the guest operating system, but
does not automatically mount it.</li>
<li>To do that, first create a directory that where you want to mount
the shared folder, such as &lsquo;foo&rsquo;.</li>
<li>Enter the following command: &lsquo;sudo mount.vboxsf home foo&rsquo; (this may
require your password).

<ul>
<li>Many people choose to mount the shared folders in /mnt/.</li>
</ul>
</li>
<li>At this point, you can transfer files back and forth.</li>
<li>Be careful not to accidentally delete all your files through the
mount point!.</li>
</ul>


<p><a href="http://dropbox.com">Dropbox</a> may be the easiest way to sync files
between your virtual machine and your host machine.  To install:</p>

<ul>
<li>download the 32-bit Ubuntu version downloaded from
<a href="https://www.dropbox.com/install?os=lnx">here</a> - be sure to save the
file, not open it, from Firefox</li>
<li>install it from the command-line via &lsquo;sudo dpkg -i
dropbox_1.4.0_i386.deb&rsquo; but note that the file name may change as a
new version is released

<ul>
<li>note: dropbox requires a supporting package (python-gpgme), but I
already installed that on the image</li>
</ul>
</li>
<li>once installed, a vibrating icon will appear in the left-hand
launcher; click on that, then click on &ldquo;Start Dropbox&rdquo;</li>
<li>this will download the proprietary daemon (a daemon is a background
process) and install it</li>
<li>at that point, the standard dropbox registration wizard will appear</li>
</ul>


<h3>Image creation details</h3>

<p>For those who are interested, here is what I did to set up the image:</p>

<ul>
<li>Create a new VirtualBox image

<ul>
<li>which I named &ldquo;Ubuntu 12.04.3&rdquo;</li>
<li>I set the disk to resize dynamically, and everything else was set
at the default</li>
</ul>
</li>
<li>I installed Ubuntu 12.04.3 LTS (32 bit), desktop edition, from the
CD image downloaded from http://www.ubuntu.com (the specific image
file is
<a href="http://releases.ubuntu.com/precise/ubuntu-12.04.3-desktop-i386.iso">here</a>

<ul>
<li>when prompted, I clicked on &lsquo;download updates&rsquo; and &lsquo;install 3rd
party software&rsquo; when the options were given</li>
<li>The computer name is cassiopeia, the login name is &lsquo;student&rsquo;, full
name is &lsquo;L33t Hax0r&rsquo;, and the password is &lsquo;password&rsquo;</li>
<li>this account can run root (system) commands via &lsquo;sudo&rsquo; - if you
don&rsquo;t know what this means, you can safely ignore it</li>
</ul>
</li>
<li>Once it was finished, I rebooted, and logged in</li>
<li>I ran &lsquo;sudo apt-get update&rsquo; and then &lsquo;sudo apt-get dist-upgrade&rsquo;.</li>
<li>installed the other packages: <code>sudo apt-get install clang emacs nasm
astyle tofrodos source-highlight doxygen doxygen-doc ddd git g++
python-gpgme</code>

<ul>
<li>python-gpgme is a supporting package for Dropbox, in case students
want to install that</li>
</ul>
</li>
<li>Reboot after all these apt-gets, and then ran &lsquo;apt-get autoremove&rsquo;
and &lsquo;apt-get clean&rsquo;.</li>
<li>Ran the following two commands:

<ul>
<li><code>sudo update-alternatives --set cc /usr/bin/clang</code></li>
<li><code>sudo update-alternatives --set c++ /usr/bin/clang++</code></li>
</ul>
</li>
<li>Downloaded Google Chrome from
<a href="https://www.google.com/intl/en/chrome/browser/">here</a>, and installed
it via &lsquo;sudo dpkg -i google-chrome-stable_current_i386.deb&rsquo;

<ul>
<li>That installation did not work perfectly (which was expected), and
to fix an installation such as this you run &lsquo;sudo apt-get -f
install&rsquo;</li>
<li>Then ran &lsquo;apt-get autoremove&rsquo; and &lsquo;apt-get clean&rsquo; again</li>
</ul>
</li>
<li>Added terminal, emacs, and google chrome icons to the launch bar</li>
<li>Browser customization

<ul>
<li>Set both firefox and chrome&rsquo;s home page to Collab</li>
<li>Cleared both histories</li>
<li>Chrome is set as the default browser</li>
</ul>
</li>
<li>The VirtualBox &ldquo;Guest Additions&rdquo; are what allow for proper mouse
integration and, more importantly, proper full-screening.  The ones
that the system wanted to install (via System Settings -> Hardware ->
Additional Drivers) appear to have a
<a href="https://www.virtualbox.org/ticket/11709">bug</a> that has since been
fixed.  So I installed the latest version of the guest additions
(4.3.6, which matches the latest version of VirtualBox) via the
VirtualBox menu item Devices->Insert Guest Additions CD Image, and
then rebooted.  At that point, the system would full screen
properly.</li>
<li>I loaded up emacs, and then told it to disable showing the startup
messages (this could also be accomplished by following the
guidelines <a href="http://xenon.stanford.edu/~manku/dotemacs.html">here</a>).</li>
<li>Added a few aliases were added (the last 4 lines of .bashrc) to help
prevent people from accidentally removing files (adding -i for rm,
mv, and cp; and aliasing xemacs to emacs)</li>
<li>Cloned the github repo via <code>git clone
https://github.com/aaronbloomfield/pdr</code>

<ul>
<li>Note that a <code>git pull</code> will still have to be executed each time to
update it</li>
<li>I added the pdr/cs2150/index.html page as the second tab loaded up
by both Firefox and Chrome</li>
</ul>
</li>
<li>Ran <code>history -c</code> to remove the history of the command entered</li>
<li>To reduce the size of the hard disk (since I have to host it for
people to download), I ran &ldquo;cat /dev/zero > zero&rdquo; until it ran out
of space, then removed that file (this writes all 0&rsquo;s to the hard
drive).  I shut down the guest, and ran: &lsquo;VBoxManage modifyhd
ubuntu-12.04.3.vdi &ndash;compact&rsquo;.  A better way would be to load up
into recovery mode and run zerofill, but the grub menu does not
seem to be easily available to load into recovery mode, so I didn&rsquo;t
pursue it any further.

<ul>
<li>Note that in the image creation process, you may run into a
problem with VirtualBox where it cannot register a new (or
different) disk because it has the same UUID as a previous disk
that you are replacing.  If so, then the command &ldquo;VBoxManage
internalcommands sethduuid disk.vdi&rdquo; will change the UUID, and
allow you to proceed</li>
</ul>
</li>
<li>A few quick notes

<ul>
<li>The guest hard drive reported 3.8 Gb of space used prior to
distribution of the image</li>
<li>the guest additions (the drivers that make Ubuntu in a VirtualBox
image work nicely with the host system) were installed by the
additional drivers step done before</li>
<li>Firefox was a recent version, and flash worked right out of the
box</li>
<li>the VM may capture the mouse - to uncapture it, you press the
&ldquo;host key&rdquo;, which is the right Control key on Linux.  To have it
warn you about what this is, you can reset all warnings via the
VirtualBox help menu, and it will warn you about this at boot-up</li>
</ul>
</li>
</ul>

</body>
</html>
